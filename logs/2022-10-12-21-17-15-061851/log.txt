Logging to ./logs/2022-10-12-21-17-15-061851
*********************** TRAIN BEGIN ***********************

command = train
data_dir = ../data/tccs/ocean/SST_modified
model_path = ./saved_models/model-pre_num_channels_8-num_channels_16-latent_dim_64-num_embeddings_128-batch_size_32-patch_size_64-abc
use_fp16 = False
verbose = True
resume = 
iter = -1
input_file = 
output_file = 
patch_size = 64
patch_depth = -1
patch_channels = 1
pre_num_channels = 8
num_channels = 16
latent_dim = 64
num_embeddings = 128
num_residual_blocks = 3
num_transformer_blocks = 2
num_heads = 4
dropout = 0.0
ema_decay = 0.99
commitment_cost = 0.25
name = model-pre_num_channels_8-num_channels_16-latent_dim_64-num_embeddings_128-batch_size_32-patch_size_64-abc
epochs = 4
lr = 0.0004
warm_up_portion = 0.15
weight_decay = 0.0001
log_interval = 10
save_interval = 10
train_verbose = True
data_height = 2400
data_width = 3600
data_depth = -1
data_channels = 1
batch_size = 32
data_shape = (1, 2400, 3600, 1)
prefix_folder = -pre_num_channels_8-num_channels_16-latent_dim_64-num_embeddings_128-batch_size_32-patch_size_64-abc

Using device: cuda:0
NVIDIA GeForce RTX 3060 Ti
Memory Usage: 
Allocated: 0.0 GB
Cached: 0.0 GB

Pytorch version: 1.12.1+cu116

number of train_files: 1
train_dataset: OverlappingDataGen(name: train; shuffle: True; patch_shape: 2x[1, 1, 64, 64])
number of test_files: 1
test_dataset: DisjointDataGen(name: test; shuffle: False; patch_shape: 2x[1, 1, 64, 64])
Training Parameters:
train.num_time_slices = 120
train.num_patch_per_time_slice = 2094
train.num_patches = 251280
train.num_batches = 7853
train.num_batch_per_time_slice = 66
train.kernel_size = [64 64]
train.stride = 56
train.padding = True
test.num_time_slices = 120
test.num_patch_per_time_slice = 2166
test.num_patches = 259920
test.num_batches = 8123
test.num_batch_per_time_slice = 68
test.padded_shape = (1, 2432, 3648, 1)
test._patch_size = 64
test._original_shape = (1, 2400, 3600, 1)
test.pad_dim = [(0, 0), (16, 16), (24, 24), (0, 0)]

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
VQCPVAE                                                      --                        --
├─Standardizer: 1-1                                          [1, 1, 64, 64]            --
├─Encoder: 1-2                                               [1, 64, 8, 8]             --
│    └─Conv2dSame: 2-1                                       [1, 8, 64, 64]            --
│    │    └─Conv2d: 3-1                                      [1, 8, 64, 64]            16
│    └─GELU: 2-2                                             [1, 8, 64, 64]            --
│    └─Conv2dSame: 2-3                                       [1, 16, 64, 64]           --
│    │    └─Conv2d: 3-2                                      [1, 16, 64, 64]           2,064
│    └─GELU: 2-4                                             [1, 16, 64, 64]           --
│    └─Conv2dSame: 2-5                                       [1, 16, 64, 64]           --
│    │    └─Conv2d: 3-3                                      [1, 16, 64, 64]           2,320
│    └─EncodingStack: 2-6                                    [1, 16, 8, 8]             --
│    │    └─ModuleList: 3-4                                  --                        14,640
│    └─Conv2dSame: 2-7                                       [1, 64, 8, 8]             --
│    │    └─Conv2d: 3-5                                      [1, 64, 8, 8]             9,280
├─Patcher2d: 1-3                                             [1, 64, 64]               --
├─PatchEmbedding: 1-4                                        [1, 64, 64]               --
│    └─Embedding: 2-8                                        [64, 64]                  4,096
│    └─Linear: 2-9                                           [1, 64, 64]               4,160
├─TransformerEncoder: 1-5                                    [1, 64, 64]               --
│    └─ModuleList: 2-10                                      --                        --
│    │    └─TransformerEncodingBlock: 3-6                    [1, 64, 64]               33,472
│    │    └─TransformerEncodingBlock: 3-7                    [1, 64, 64]               33,472
├─InversePatcher2d: 1-6                                      [1, 64, 8, 8]             --
├─VectorQuantizerEMA: 1-7                                    --                        16,384
├─Patcher2d: 1-8                                             [1, 64, 64]               --
├─PatchEmbedding: 1-9                                        [1, 64, 64]               --
│    └─Embedding: 2-11                                       [64, 64]                  4,096
│    └─Linear: 2-12                                          [1, 64, 64]               4,160
├─TransformerEncoder: 1-10                                   [1, 64, 64]               --
│    └─ModuleList: 2-13                                      --                        --
│    │    └─TransformerEncodingBlock: 3-8                    [1, 64, 64]               33,472
│    │    └─TransformerEncodingBlock: 3-9                    [1, 64, 64]               33,472
├─InversePatcher2d: 1-11                                     [1, 64, 8, 8]             --
├─Decoder: 1-12                                              [1, 1, 64, 64]            --
│    └─Conv2dTransposeSame: 2-14                             [1, 16, 8, 8]             --
│    │    └─ConvTranspose2d: 3-10                            [1, 16, 8, 8]             9,232
│    └─DecodingStack: 2-15                                   [1, 16, 64, 64]           --
│    │    └─ModuleList: 3-11                                 --                        14,640
│    └─GELU: 2-16                                            [1, 16, 64, 64]           --
│    └─Conv2dTransposeSame: 2-17                             [1, 8, 64, 64]            --
│    │    └─ConvTranspose2d: 3-12                            [1, 8, 64, 64]            1,160
│    └─GELU: 2-18                                            [1, 8, 64, 64]            --
│    └─Conv2dTransposeSame: 2-19                             [1, 1, 64, 64]            --
│    │    └─ConvTranspose2d: 3-13                            [1, 1, 64, 64]            9
├─Standardizer: 1-13                                         [1, 1, 64, 64]            --
==============================================================================================================
Total params: 220,145
Trainable params: 220,145
Non-trainable params: 0
Total mult-adds (M): 55.63
==============================================================================================================
Input size (MB): 0.02
Forward/backward pass size (MB): 8.98
Params size (MB): 0.81
Estimated Total Size (MB): 9.80
==============================================================================================================
